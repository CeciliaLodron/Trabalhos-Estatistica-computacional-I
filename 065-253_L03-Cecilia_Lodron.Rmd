---
title: "atividade 3"
author: "Cecilia Lodron Gonzaga"
date: "2025-12-12"
output: html_document
---

```{r}
df <- data.frame(
  exposição = c(rep("Exposto", 100), rep("Não exposto", 100)),
  doença = c(c(rep("Sim", 70), rep("Não", 30)), 
             c(rep("Sim", 90), rep("Não", 10)))
)
table(df)

mat <- as.table(matrix(data = c(70, 90, 30, 10), ncol = 2))
mat

f <- function(x, gama){
  #razao <- (x[1,1]*x[2, 2])/(x[1,2]*x[2,1])
  razao <- prod(x[c(1, 4)])/prod(x[c(2, 3)])
  
  erro.padrao <- sqrt(sum(1/x))
  
  alfa <- 1-gama
  z <- qnorm(p = c(alfa/2, 1-alfa/2))
  lim.log <- log(razao)+z*erro.padrao
  limites <- exp(lim.log)
  
  return(list(razão = razao, erro = erro.padrao, intervalo = limites))
}

f(mat, 0.95)
```
